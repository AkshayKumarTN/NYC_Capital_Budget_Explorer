<!-- 
This handlebar file will be rendered when the following route is hit: GET http://localhost:3000/
 -->

<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NYC Council Project Explorer App</title>
    <link rel="stylesheet" href="/public/css/homePage.css" />
    
  </head>

  <body>
    <main>

      {{>navbar}}
      {{! <section class="home-page-background">PROJECT PAGE</section> }}
      <div class="projects-page">
      <div class="tab-container">
        <button
          class="tab-link active"
          data-tab="tableTab"
        >Table</button>
        <button class="tab-link" data-tab="pieTab">Pie Chart</button>
        <button class="tab-link" data-tab="barTab" >Bar Chart</button>
      </div>
         <div id= "tableTab" class="tab-content" style="display: block;">
            <div class="table-filters">
              <select id="searchBorough" class="input-select">
                <option value="">All Boroughs</option>
                {{#each boroughValues}}
                  <option value="{{this}}">{{this}}</option>
                {{/each}}
              </select>

              <select id="searchFy" class="input-select">
                <option value="">All Fiscal Years</option>
                {{#each fiscalYears}}
                  <option value="{{this}}">{{this}}</option>
                {{/each}}
              </select>

              <select id="searchDistrict" class="input-select">
                <option value="">All Counsil District</option>
                {{#each councilDistrict}}
                <option value="{{this}}">{{this}}</option>
                {{/each}}
              </select>

              <input id="searchSponsor" type="text" placeholder="Search Sponsor..." class="input-text"/>
              <button id="searchFilters" class="primary-button">Search</button>
              <button id="resetFilters" class="secondary-button">Reset</button>
            </div>

            <div class="table-container">
              <div class="table">
              <table id="budgetTable">
                <thead>
                  <tr>
                    <th>Project Description</th>
                    <th>Project Id</th>
                    <th>Borough</th>
                    <th>Amount ($)</th>
                    <th>Sponsor</th>
                    <th>Reported Year</th>
                    <th>Fiscal Year</th>
                    <th>Counsil District</th>
                  </tr>
                </thead>
                <tbody>
                  {{#each projects}}
                    <tr>
                      <td><a href="/projects/{{this.id}}">{{this.description}}</a></td>
                      <td>{{this.id}}</td>
                      <td>{{this.borough_full}}</td>
                      <td>{{this.award_formatted}}</td>
                      <td>{{this.sponsor}}</td>
                      <td>{{this.reported}}</td>
                      <td>{{this.fiscal_year}}</td>
                      <td>{{this.councilDistrictToStr}}</td>
                    </tr>
                  {{/each}}
                </tbody>
              </table>
              </div>
            </div>
          </div>

            <div id="pieTab" class="tab-content" style="display: none;">
              <div class="table-filters">
              <select id="pieSearchBorough" class="input-select">
                <option value="">All Boroughs</option>
                {{#each boroughValues}}
                  <option value="{{this}}">{{this}}</option>
                {{/each}}
              </select>

              <select id="pieSearchFy" class="input-select">
                <option value="">All Fiscal Years</option>
                {{#each fiscalYears}}
                  <option value="{{this}}">{{this}}</option>
                {{/each}}
              </select>

              <select id="pieSearchDistrict" class="input-select">
                <option value="">All Counsil District</option>
                {{#each councilDistrict}}
                <option value="{{this}}">{{this}}</option>
                {{/each}}
              </select>

              <input id="pieSearchSponsor" type="text" placeholder="Search Sponsor..." class="input-text"/>
              <button id="pieSearchFilters" class="primary-button">Search</button>
              <button id="pieResetFilters" class="secondary-button">Reset</button>
            </div>
              <div class = "pieDimensions">
              <label for="groupByDropdown">Group By:</label>
              <select id="groupByDropdown" class="input-select">
                <option value="borough">Borough</option>
                <option value="reportedYear">Reported Year</option>
                {{!-- <option value="councilDistrict">Council District</option> --}}
              </select>
              </div>
              <canvas id="pieChartCanvas" class="pieChartCanvas" width="400" height="400"></canvas>
              <p id="noPieDataMessage" style="display: none; text-align: center;">
                No data available for the selected filters.
              </p>

            </div>

            
            <div id="barTab" class="tab-content" style="display: none;">
              <div class="filter-controls">
                <select id="filterDistrict">
                  <option value="">All Districts</option>
                </select>
                <select id="filterAgency">
                  <option value="">All Agencies</option>
                </select>
                <select id="filterCategory">
                  <option value="">All Categories</option>
                </select>
                <select id="filterYear">
                  <option value="">All Years</option>
                </select>
              </div>
              
              <canvas id="barChartCanvas" width="800" height="600"></canvas>

            </div>
          
      </div>
      </div>

      {{>footer}}
    </main>
    <script src="/public/js/scripts.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </body>

</html>